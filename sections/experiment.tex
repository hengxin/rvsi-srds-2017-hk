\section{Experimental Evaluation}

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    Impacts of \rvsi{} specification \\[5pt]
    on the \emph{\blue{transaction abort rates}} in various scenarios
  \end{center}

  \pause
  \vspace{0.50cm}
  \centerline{\red{What about performance?}}
  \begin{itemize}
    \item Not done yet in this work
    \item \rvsims{} and \rvsimp{} protocols in \chameleon{} are simple
  \end{itemize}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{columns}
    \column{0.50\textwidth}
      \chameleon{} prototype on Aliyun:
      \begin{itemize}
	\item 3 datacenters~\footnotemark[1]
	\item 3 nodes in each datacenter
	\item Partition \& Replication
	\item Clients in our lab~\footnotemark[2]
      \end{itemize}

      \vspace{0.60cm}
      \uncover<2->{
	(One-way) delays among nodes~\footnotemark[3]:
	\begin{description}[Across datacenters:]
	  \item[Within datacenter:] $1 \sim 2$ms
	  \item[Across datacenters:] $15 \sim 25$ms
	  \item[Clients to nodes:] $15 \sim 20$ms
	\end{description}
      }
    \column{0.50\textwidth}
      \fignocaption{width = 0.85\textwidth}{figs/chameleon-arch.pdf}
  \end{columns}

  \footnotetext[1]{Located in East China, North China, and South China, respectively.}
  \footnotetext[2]{Located in East China.}
  \footnotetext[3]{\url{https://github.com/hengxin/aliyun-ping-traces}}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \centerline{Three categories of workload parameters for experiments on Aliyun.}
  \input{tables/rvsi-workload}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  Transactions abort for two reasons:
  \begin{itemize}
    \item \red{``vc-aborted''}: \rvsi{} version constraints violated
    \item \blue{``wcf-aborted''}: the WCF property violated
  \end{itemize}

  \pause
  \vspace{0.60cm}
  Transaction abort rates due to \red{``vc-aborted''} are \emph{sensitive} to different values of $k_1$, $k_2$, or $k_3$,
  \pause
  but those due to \blue{``wcf-aborted''} are not.

  \pause
  \vspace{0.50cm}
  \[
    h \in \rvsi{} \iff h \in \red{\konebv{}} \cap \red{\ktwofv{}} \cap \red{\kthreesv{}} \cap \blue{\wcf{}}.
  \]

  \pause
  \vspace{0.80cm}
  \centerline{\red{We report the results 
    under the read-frequent workloads~\footnote{\url{https://github.com/hengxin/chameleon-transactional-kvstore}}.}}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \fignocaption{width = 0.80\textwidth}{figs/aliyun-vc-rf.pdf}

  \pause
  The transaction abort rates due to ``vc-aborted'' \pause can be \red{greatly reduced}
  by \blue{slightly} increasing the values of $k_1$, $k_2$, or $k_3$:
  \[
    vc(1,0,0) = 0.1994 \implies vc(2,1,1) = 0.0091 \quad (\text{\#clients} = 30)
  \]
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \fignocaption{width = 0.55\textwidth}{figs/aliyun-bvfvsv.pdf}

  \pause
  Most ``vc-aborted'' transactions abort because of violating \red{$\ktwofv$}.
  \[
    fv(1,0,0) = 0.1889 \implies fv(\blue{2},0,0) = 0.1866 \implies fv(1,\red{\bf 1},0) = 0.0064
  \]
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{center}
    \red{Question: when does $k_1$ for $\konebv$ take effect?} \\[10pt]
    It seems that $\konebv$ has \emph{\red{little}} impact on the transaction abort rates. \\[30pt]
    \pause
    It may be the case in the Aliyun scenarios. \\[10pt]
    \blue{What about other scenarios?}
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \centerline{Three types of delays for \blue{\large controlled experiments} on local hosts.}
  \begin{center}
    % \resizebox{0.50\textwidth}{!}{\input{tikz/delay-types}}
    \input{tikz/delay-types}
  \end{center}

  % \uncover<2>{{\bf issueDelay} (ms)  \hspace{8pt} 5, 8, 10, 12, 15, 20	 \hspace{8pt} delays between clients and replicas}
  \input{tables/rvsi-delay-localhost}
\end{frame}
%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  \begin{columns}
    \column{0.50\textwidth}
      \fignocaption{width = 0.90\textwidth}{figs/simlog-rw4.pdf}
      \vspace{-0.40cm}
      \centerline{\footnotesize (Under read-frequent workloads.)}
    \column{0.50\textwidth}
      \fignocaption{width = 0.90\textwidth}{figs/simlog-rw05.pdf}
      \vspace{-0.40cm}
      \centerline{\footnotesize (Under write-frequent workloads.)}
  \end{columns}

  \vspace{0.40cm}
  \begin{center}
    When the \textcolor{teal}{``issueDelay''} gets shorter, \\
    % the impacts of \blue{$\ktwofv$} go weaker, \\
    the impacts of \red{$\konebv$} have begun to emerge.
  \end{center}
\end{frame}
%%%%%%%%%%%%%%%

% %%%%%%%%%%%%%%%
% \begin{frame}{}
%   \begin{description}[issueDelay = 20ms:]
%     \setlength{\itemsep}{10pt}
%     \item[issueDelay = 20ms:] $bv(1,0,0) = \red{0.0057} \quad\;\; fv(1,0,0) = 0.0251$
%     \item[issueDelay = 15ms:] $bv(1,0,0) = \red{0.08225} \quad fv(1,0,0) = 0.0393$
%     \item[issueDelay = 5ms:] $bv(1,0,0) = \red{0.1716} \quad\;\; fv(1,0,0) = 0.0045$
%   \end{description}
% 
%   \pause
%   \vspace{0.50cm}
%   \begin{center}
%     \blue{larger issueDelay} $\implies$ longer transaction \\[5pt]
%     more concurrent transactions \\[5pt]
%     more likely to obtain data versions updated by concurrent transactions \\[5pt]
%     more sensitive to \blue{$\ktwofv$}
%   \end{center}
% \end{frame}
% %%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%
\begin{frame}{}
  Generally, \rvsi{} \blue{\it helps to reduce the transaction abort rates}
  when applications are willing to tolerate certain anomalies.

  \pause
  \vspace{0.6cm}
  \begin{description}[<+->]
    \setlength{\itemsep}{5pt}
    \item[$\ktwofv$:] In the Aliyun scenarios, most transactions have been aborted because of violating $\ktwofv$.
    \item[$\konebv$:] In controlled experiments, the impacts of $\konebv$ emerge when the ``issueDelay'' gets shorter.
    \item[$\kthreesv$:] \uncover<4->{\textcolor{gray}{Complex and challenging (involving multiple data items)}}
  \end{description}
\end{frame}
%%%%%%%%%%%%%%%
